<!DOCTYPE html>
<html>
<head>
  <title>Мессенджер</title>
  <style>
    #chat { border: 1px solid #ccc; padding: 10px; height: 300px; overflow-y: scroll; }
  </style>
</head>
<body>
  <div id="chat"></div>
  <input id="message" placeholder="Ваше сообщение">
  <input id="user" placeholder="Ваше имя">
  <button onclick="sendMessage()">Отправить</button>

  <script>
    const chat = document.getElementById('chat');
    const messageInput = document.getElementById('message');
    const userInput = document.getElementById('user');

    // WebSocket для реального времени
    const ws = new WebSocket('wss://ваш-сервер.glitch.me');

    ws.onmessage = (event) => {
      const msg = JSON.parse(event.data);
      chat.innerHTML += `<p><b>${msg.user}:</b> ${msg.text}</p>`;
    };

    // Загрузка старых сообщений
    fetch('https://ваш-сервер.glitch.me/messages')
      .then(res => res.json())
      .then(messages => {
        messages.reverse().forEach(msg => {
          chat.innerHTML += `<p><b>${msg.user}:</b> ${msg.text}</p>`;
        });
      });

    // Отправка нового сообщения
    function sendMessage() {
      const text = messageInput.value;
      const user = userInput.value;
      const message = { text, user };

      ws.send(JSON.stringify(message));
      fetch('https://ваш-сервер.glitch.me/messages', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(message)
      });

      messageInput.value = '';
    }
  </script>
</body>
</html>
